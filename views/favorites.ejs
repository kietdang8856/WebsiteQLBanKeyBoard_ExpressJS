<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="description" content="" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <!-- The above 4 meta tags *must* come first in the head; any other head content must come *after* these tags -->

  <!-- Title  -->
  <title>KietCap</title>

  <!-- Favicon  -->
  <link rel="icon" href="/public/img/core-img/favicon.ico" />

  <!-- Core Style CSS -->
  <link rel="stylesheet" href="/public/css/core-style.css" />
  <link rel="stylesheet" href="/public/css/style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" />
</head>

<body>
  <!-- Search Wrapper Area Start -->
  <div class="search-wrapper section-padding-100">
    <div class="search-close">
      <i class="fa fa-close" aria-hidden="true"></i>
    </div>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <div class="search-content">
            <form action="/product/search" method="get">
              <input type="search" name="search" id="search" placeholder="Nhập từ khóa..." />
              <button type="submit">
                <img src="/public/img/core-img/search.png" alt="" />
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Search Wrapper Area End -->

  <!-- ##### Main Content Wrapper Start ##### -->
  <div class="main-content-wrapper d-flex clearfix">
    <!-- Mobile Nav (max width 767px)-->
    <div class="mobile-nav">
      <!-- Navbar Brand -->
      <div class="amado-navbar-brand">
        <a href="/"><img src="/public/img/core-img/logo.png" alt="" /></a>
      </div>
      <!-- Navbar Toggler -->
      <div class="amado-navbar-toggler">
        <span></span><span></span><span></span>
      </div>
    </div>

    <!-- Header Area Start -->
    <%- include('partials/header'); -%>
    <!-- Header Area End -->

    <div class="shop_sidebar_area">
      <!-- ##### Single Widget ##### -->
      <div class="widget brands mb-50">
        <!-- Widget Title -->
        <h6 class="widget-title mb-30">Loại sản phẩm</h6>

        <div class="widget-desc">
          <!-- Single Form Check -->
          <form class="typeFilter" action="/product/product-filter" method="post">
            <% types.forEach(element=> {%>
              <div class="form-check">
                <input class="form-check-input" name="selection" type="checkbox"
                    value="<%= element._id %>" />
                  <label class="form-check-label" for="<%= element.typeName.toLowerCase() %>">
                    <%= element.typeName %>
                  </label>
              </div>
              <%}) %>
          </form>
        </div>
      </div>
      <!-- ##### Single Widget ##### -->
      <div class="widget brands mb-50">
        <!-- <script>
    function sort(event) {
      console.log(event.target.value);
      single-product-wrapper
      console.log(listProduct)
    }
  </script>Widget Title -->
        <h6 class="widget-title mb-30">Thương hiệu</h6>

        <div class="widget-desc">
          <!-- Single Form Check -->
          <form class="supplierFilter" action="/product/product-filter" method="post">
            <% suppliers.forEach(element=> {%>
              <div class="form-check">
                <input class="form-check-input" name="supplier" type="checkbox" value="<%= element._id %>"
                  id="<%= element.supplierName.toLowerCase() %>" />
                <label class="form-check-label" for="<%= element.supplierName.toLowerCase() %>">
                  <%= element.supplierName %>
                </label>
              </div>
              <%}) %>
          </form>
        </div>
      </div>
    </div>

    <div class="amado_product_area section-padding-100">
      <div class="container-fluid">
        <div class="row">
          <div class="col-12">
            <div class="product-topbar d-xl-flex align-items-end justify-content-between">
              <!-- Total Products -->
              <div class="total-products">
                <h3>
                  <%= types.typeName %>
                </h3>
                <div class="view d-flex">
                  <h3>Sản phẩm yêu thích</h3>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <!-- Single Product Area -->
          <% product=data.length> itemsPerPage ? data.slice((currentPage - 1) * itemsPerPage, currentPage *
            itemsPerPage) : data%>
            <% product.forEach(element=> {%>
              <% if(element.description.status==true){%>
                <div class="col-12 col-sm-6 col-md-12 col-xl-6">
                  <div class="single-product-wrapper">
                    <!-- Product Image -->
                    <div class="product-img">
                      <img src="<%= element.description.imageList[0] %> " alt="Image" />
                      <!-- Hover Thumb -->
                      <img class="hover-img" src="<%= element.description.imageList[1] %> " alt="Image" />
                    </div>

                    <!-- Product Description -->
                    <div class="product-description d-flex align-items-center justify-content-between">
                      <!-- Product Meta Data -->
                      <div class="product-meta-data">
                        <div class="line"></div>
                        <p class="product-price">
                          <%= element.description.price.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1,' ) %>đ
                        </p>
                        <a href="/product/<%= element._id %> ">
                          <h6>
                            <%= element.productName %>
                          </h6>
                        </a>
                      </div>
                      <!-- Ratings & Cart -->
                      <div class="ratings-cart text-right">
                        <div class="ratings">
                          <i class="fa fa-star" aria-hidden="true"></i>
                          <i class="fa fa-star" aria-hidden="true"></i>
                          <i class="fa fa-star" aria-hidden="true"></i>
                          <i class="fa fa-star" aria-hidden="true"></i>
                          <i class="fa fa-star" aria-hidden="true"></i>
                        </div>
                        <div class="cart" style="display: flex; justify-content: center; align-items: center;">
                          <a class="mr-2" href="/product/favorite/delete/<%= element._id %>" data-toggle="tooltip" data-placement="left"
                            title="Bỏ thích"><img width="20px" src="/public/img/core-img/love.svg" alt="" /></a>
                          <a href="/cart/<%= element._id %>" data-toggle="tooltip" data-placement="left"
                            title="Thêm vào giỏ hàng"><img src="/public/img/core-img/cart.png" alt="" /></a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <%} %>
                  <%}) %>
        </div>

        <div class="row">
          <div class="col-12">
            <!-- Pagination -->
            <nav aria-label="navigation">
              <ul class="pagination justify-content-end mt-50">
                <% totalPage=data.length % itemsPerPage !=0 ? (data.length / itemsPerPage) + 1 : data.length /
                  itemsPerPage %>
                  <% for(var i=1; i <=totalPage; i++){%>
                    <li class="page-item <%= i == currentPage ? 'active' : '' %> ">
                      <a class="page-link" href="/favorite/page/<%= i %> ">0<%= i %> .</a>
                    </li>
                    <%} %>
              </ul>
            </nav>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- ##### Main Content Wrapper End ##### -->

  <!-- ##### Newsletter Area Start ##### -->
  <section class="newsletter-area section-padding-100-0">
    <div class="container">
      <div class="row align-items-center">
        <!-- Newsletter Text -->
        <div class="col-12 col-lg-6 col-xl-7">
          <div class="newsletter-text mb-100">
            <h2>Subscribe for a <span>25% Discount</span></h2>
            <p>
              Nulla ac convallis lorem, eget euismod nisl. Donec in libero sit
              amet mi vulputate consectetur. Donec auctor interdum purus, ac
              finibus massa bibendum nec.
            </p>
          </div>
        </div>
        <!-- Newsletter Form -->
        <div class="col-12 col-lg-6 col-xl-5">
          <div class="newsletter-form mb-100">
            <form action="#" method="post">
              <input type="email" name="email" class="nl-email" placeholder="Your E-mail" />
              <input type="submit" value="Subscribe" />
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- ##### Newsletter Area End ##### -->

  <!-- ##### Footer Area Start ##### -->
  <footer class="footer_area clearfix">
    <div class="container">
      <div class="row align-items-center">
        <!-- Single Widget Area -->
        <div class="col-12 col-lg-4">
          <div class="single_widget_area">
            <!-- Logo -->
            <div class="footer-logo mr-50">
              <a href="index.html"><img src="/public/img/core-img/logo2.png" alt="" /></a>
            </div>
            <!-- Copywrite Text -->
            <p class="copywrite">
              <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
              Copyright &copy;
              <script>
                document.write(new Date().getFullYear());
              </script>
              All rights reserved | This template is made with
              <i class="fa fa-heart-o" aria-hidden="true"></i> by
              <a href="https://colorlib.com" target="_blank">Colorlib</a> &
              Re-distributed by
              <a href="https://themewagon.com/" target="_blank">Themewagon</a>
              <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            </p>
          </div>
        </div>
        <!-- Single Widget Area -->
        <div class="col-12 col-lg-8">
          <div class="single_widget_area">
            <!-- Footer Menu -->
            <div class="footer_menu">
              <nav class="navbar navbar-expand-lg justify-content-end">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#footerNavContent"
                  aria-controls="footerNavContent" aria-expanded="false" aria-label="Toggle navigation">
                  <i class="fa fa-bars"></i>
                </button>
                <div class="collapse navbar-collapse" id="footerNavContent">
                  <ul class="navbar-nav ml-auto">
                    <li class="nav-item active">
                      <a class="nav-link" href="/">Trang chủ</a>
                    </li>
                    <li class="nav-item active">
                      <a class="nav-link" href="/product">Sản phẩm</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="#">Phí vận chuyển</a>
                    </li>
                    <li class="nav-item"><a class="nav-link" href="#">Hỗ trợ</a></li>
                    <li class="nav-item">
                      <a class="nav-link" href="#">Về chúng tôi</a>
                    </li>
                  </ul>
                </div>
              </nav>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <!-- ##### Footer Area End ##### -->

  <!-- ##### jQuery (Necessary for All JavaScript Plugins) ##### -->
  <script src="/public/js/jquery/jquery-2.2.4.min.js"></script>
  <!-- Popper js -->
  <script src="/public/js/popper.min.js"></script>
  <!-- Bootstrap js -->
  <script src="/public/js/bootstrap.min.js"></script>
  <!-- Plugins js -->
  <script src="/public/js/plugins.js"></script>
  <!-- Active js -->
  <script src="/public/js/active.js"></script>
  <script type='text/javascript'>

    $(document).ready(function() { 
      $('input[name=supplier]').change(function(){
           $('form.supplierFilter').submit();
      });
      $('input[name=selection]').change(function(){
           $('form.typeFilter').submit();
      });
     });
   
   </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
  <% if(message && message.length> 0){%>
    <script>
      toastr.success("<%= message %>", "Thông báo", {
        timeOut: 1500,
        progressBar: true,
        closeButton: true,
      });
    </script>
    <%} %>
</body>
</body>

</html>